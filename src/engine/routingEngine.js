export function getRouteSummary(start, end, features, config) { const distance = Math.abs(end - start); const distanceMiles = distance * (config.milesPerMeter || 0.000621371); const direction = end > start ? "Forward" : "Reverse"; const [min, max] = end > start ? [start, end] : [end, start]; const locksInRoute = features.filter(f => f.type === "lock" && f.chainage >= min && f.chainage <= max); const lockCount = locksInRoute.length; const lockTime = lockCount * (config.lockTimeMinutes || 30) / 60; const travelTime = distanceMiles / (config.speedMph || 3); const etaHours = travelTime + lockTime; const nextFeature = features.find(f => direction === "Forward" ? f.chainage > start : f.chainage < start); return { direction, distance, distanceMiles, lockCount, etaHours, nextFeature }; } export function getWindowFeatures(start, direction, hours, speed, features, config) { const milesPerMeter = config.milesPerMeter || 0.000621371; const distanceInWindow = hours * speed / milesPerMeter; const end = direction === "Forward" ? start + distanceInWindow : start - distanceInWindow; const [min, max] = end > start ? [start, end] : [end, start]; const items = features.filter(f => f.chainage >= min && f.chainage <= max); return { items, distance: Math.abs(end - start), hours }; }